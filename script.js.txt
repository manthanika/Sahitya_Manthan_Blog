document.addEventListener("DOMContentLoaded", function () {
  // Like button
  document.querySelectorAll(".like-btn").forEach(button => {
    button.addEventListener("click", function () {
      const blogId = this.getAttribute("data-blog-id");
      sendToGoogleSheet("Likes", { blogId, action: "like" })
        .then(() => {
          const countSpan = this.querySelector(".like-count");
          countSpan.textContent = parseInt(countSpan.textContent) + 1;
        });
    });
  });

  // Dislike button
  document.querySelectorAll(".dislike-btn").forEach(button => {
    button.addEventListener("click", function () {
      const blogId = this.getAttribute("data-blog-id");
      sendToGoogleSheet("Likes", { blogId, action: "dislike" })
        .then(() => {
          const countSpan = this.querySelector(".dislike-count");
          countSpan.textContent = parseInt(countSpan.textContent) + 1;
        });
    });
  });

  // Comment toggle
  document.querySelectorAll(".comment-toggle").forEach(button => {
    button.addEventListener("click", function () {
      const commentSection = this.parentElement.querySelector(".comment-section");
      commentSection.style.display = commentSection.style.display === "none" ? "block" : "none";
    });
  });

  // Comment submit
  document.querySelectorAll(".comment-submit").forEach(button => {
    button.addEventListener("click", function () {
      const blogId = this.getAttribute("data-blog-id");
      const commentInput = this.parentElement.querySelector(".comment-input");
      const comment = commentInput.value.trim();
      if (comment) {
        sendToGoogleSheet("Comments", { blogId, comment })
          .then(() => {
            commentInput.value = "";
            alert("Comment submitted!");
          });
      }
    });
  });

  // Login form
  document.getElementById("loginForm")?.addEventListener("submit", function (e) {
    e.preventDefault();
    const formData = new FormData(this);
    const data = {
      email: formData.get("email"),
      password: formData.get("password"),
      sheetType: "Logins",
    };
    sendToGoogleSheet("Logins", data)
      .then(() => {
        document.getElementById("loginMessage").textContent = "Login recorded!";
      });
  });

  // Google Sheets integration
 function loadBlogs() {
  const scriptURL = "https://script.google.com/macros/s/AKfycbyJ1kADVIb_hp4pvGIGbZC_6gK2tgcF2CtfnWxHNLVK4qh9RTirxY7fydgbxvzYPEoG/exec";
  fetch(scriptURL, {
    method: "POST", // Adjust if GET is needed
    headers: { "Content-Type": "application/json" },
    mode: "cors",
    redirect: "follow",
  })
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log("Blogs loaded:", data);
      // Process blogs
    })
    .catch(error => console.error("Error loading blogs:", error));
}
